{{/* psipred_jobs.html - simple jobs table */}}
<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <title>PSIPRED Jobs — DRD4</title>
    <link href="/static/styles.css" rel="stylesheet" />
</head>

<body>
    <div class="container">
        <header class="topnav">
            <div class="brand">DRD4 Explorer</div>
            <nav class="navlinks">
                <a href="/">Home</a>
                <a href="/psipred-jobs" class="primary">PSIPRED Jobs</a>
            </nav>
        </header>

        <main class="panel" style="margin-top:12px">
            <h2>PSIPRED Jobs</h2>
            <p class="meta">Acompanhamento simples dos jobs registrados no database.json</p>

            {{ if . }}
            <table class="jobs" id="psipred-jobs-table" hx-get="/psipred-jobs/fragment" hx-trigger="every 30s"
                hx-swap="outerHTML">
                <thead>
                    <tr>
                        <th>Job ID</th>
                        <th>Variant</th>
                        <th>Remote UUID</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="psipred-jobs-tbody">
                    {{ range . }}
                    <tr>
                        <td><code>{{ .ID }}</code></td>
                        <td><a href="/variant/{{ .VariantCode }}">{{ .VariantCode }}</a></td>
                        <td>{{ if .RemoteUUID }}<a href="/psipred/job/{{ .RemoteUUID }}">{{ .RemoteUUID }}</a>{{ else
                            }}—{{ end }}</td>
                        <td>
                            <span class="badge">{{ .State }}</span>
                            {{ if .RemoteState }}
                            <div class="remote-state">remote: <strong>{{ .RemoteState }}</strong></div>
                            {{ end }}
                        </td>
                        <td>
                            <a class="btn secondary view-link" href="/psipred/job/{{ or .RemoteUUID .ID }}">Ver</a>
                            <button class="btn" data-job-id="{{.ID}}">Status</button>
                        </td>
                    </tr>
                    {{ end }}
                </tbody>
            </table>
            {{ else }}
            <div class="meta">Nenhum job PSIPRED encontrado.</div>
            {{ end }}

        </main>
    </div>
    <!-- Modal for job details -->
    <div id="job-modal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="job-modal-title">
        <div class="modal-backdrop" data-dismiss="modal"></div>
        <div class="modal-panel">
            <header class="modal-header">
                <h3 id="job-modal-title">Job details</h3>
                <button class="btn secondary" id="modal-close">Fechar</button>
            </header>
            <div class="modal-body" id="job-modal-body">
                <pre id="job-modal-pre">Carregando...</pre>
            </div>
        </div>
    </div>
</body>

</html>